<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Admin 5.0 - Final</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- ESTILOS DO PAINEL (MANTIDOS) --- */
        :root { --bg-body:#0d0d0d; --bg-panel:#141414; --bg-input:#1a1a1a; --border:#2a2a2a; --accent:#25f4ee; --accent-hover:#1ccbc6; --pink:#fe2c55; --text-main:#ececec; --text-muted:#888; --sidebar-width:240px; }
        * { margin:0; padding:0; box-sizing:border-box; outline:none; }
        body { background-color:var(--bg-body); color:var(--text-main); font-family:'Inter', sans-serif; display:flex; height:100vh; overflow:hidden; font-size:13px; }
        .sidebar { width:var(--sidebar-width); background:var(--bg-panel); border-right:1px solid var(--border); display:flex; flex-direction:column; padding:20px; flex-shrink:0; }
        .brand { font-size:18px; font-weight:700; color:#fff; display:flex; align-items:center; gap:8px; padding-bottom:20px; border-bottom:1px solid var(--border); margin-bottom:20px; }
        .brand span { color:var(--accent); }
        .menu-group { margin-bottom:20px; }
        .menu-title { font-size:10px; font-weight:700; color:var(--text-muted); text-transform:uppercase; letter-spacing:0.5px; margin-bottom:8px; padding-left:10px; }
        .nav-btn { width:100%; display:flex; align-items:center; gap:10px; padding:10px; background:transparent; border:none; color:var(--text-muted); border-radius:6px; cursor:pointer; transition:all 0.2s; font-weight:500; font-size:13px; text-align:left; }
        .nav-btn:hover { background:var(--border); color:#fff; }
        .nav-btn.active { background:rgba(37, 244, 238, 0.08); color:var(--accent); border:1px solid rgba(37, 244, 238, 0.1); }
        .nav-btn svg { width:16px; height:16px; }
        .main-content { flex:1; display:flex; flex-direction:column; overflow:hidden; position:relative; }
        .top-bar { height:60px; background:var(--bg-panel); border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; padding:0 25px; }
        .top-title h1 { font-size:16px; font-weight:600; }
        .top-actions .btn-link { color:var(--text-muted); text-decoration:none; font-size:12px; display:flex; align-items:center; gap:5px; transition:0.2s; }
        .top-actions .btn-link:hover { color:var(--accent); }
        .workspace { flex:1; overflow:hidden; position:relative; }
        .tab-view { display:none; height:100%; }
        .tab-view.active { display:flex; }
        .creator-layout { display:grid; grid-template-columns:400px 1fr; height:100%; width:100%; }
        .control-panel { background:var(--bg-panel); border-right:1px solid var(--border); overflow-y:auto; padding:20px; }
        .control-panel::-webkit-scrollbar { width:5px; }
        .control-panel::-webkit-scrollbar-thumb { background:#333; border-radius:3px; }
        details { background:var(--bg-input); border:1px solid var(--border); border-radius:8px; margin-bottom:10px; overflow:hidden; }
        summary { padding:12px 15px; cursor:pointer; font-weight:600; user-select:none; display:flex; align-items:center; justify-content:space-between; background:var(--bg-panel); }
        summary:hover { background:#1f1f1f; }
        .details-content { padding:15px; border-top:1px solid var(--border); }
        .form-group { margin-bottom:12px; }
        .form-row { display:grid; grid-template-columns:1fr 1fr; gap:10px; }
        label { display:block; margin-bottom:6px; font-size:11px; font-weight:500; color:var(--text-muted); text-transform:uppercase; }
        input, textarea, select { width:100%; background:#0a0a0a; border:1px solid var(--border); border-radius:6px; padding:10px; color:#fff; font-family:'Inter', sans-serif; font-size:13px; transition:0.2s; }
        input:focus, textarea:focus, select:focus { border-color:var(--accent); background:#111; }
        .action-bar { padding:15px; background:var(--bg-panel); border-top:1px solid var(--border); display:flex; gap:10px; position:sticky; bottom:0; }
        .btn { flex:1; padding:12px; border-radius:6px; border:none; font-weight:600; cursor:pointer; font-size:13px; transition:0.2s; }
        .btn-primary { background:var(--accent); color:#000; }
        .btn-primary:hover { background:var(--accent-hover); }
        .btn-secondary { background:#2a2a2a; color:#fff; border:1px solid var(--border); }
        .btn-secondary:hover { background:#333; border-color:#444; }
        .upload-wrapper { margin-bottom:20px; border:2px dashed var(--border); border-radius:8px; padding:15px; text-align:center; background:rgba(255,255,255,0.02); transition:0.3s; }
        .upload-wrapper:hover { border-color:var(--accent); background:rgba(37, 244, 238, 0.05); }
        .btn-upload { background:transparent; border:none; color:var(--accent); font-weight:600; cursor:pointer; display:flex; align-items:center; justify-content:center; gap:8px; width:100%; }
        .preview-stage { background:#000; display:flex; align-items:center; justify-content:center; padding:40px; background-image:radial-gradient(#1a1a1a 1px, transparent 1px); background-size:20px 20px; }
        .device-mockup { width:340px; height:680px; background:#fff; border-radius:40px; border:10px solid #222; box-shadow:0 30px 60px rgba(0,0,0,0.6); overflow:hidden; position:relative; }
        .device-notch { position:absolute; top:0; left:50%; transform:translateX(-50%); width:150px; height:25px; background:#222; border-bottom-left-radius:16px; border-bottom-right-radius:16px; z-index:10; }
        #previewFrame { width:100%; height:100%; border:none; }
        .vitrine-layout { padding:30px; overflow-y:auto; width:100%; }
        .data-table { width:100%; border-collapse:collapse; font-size:13px; }
        .data-table th { text-align:left; padding:10px; border-bottom:1px solid var(--border); color:var(--text-muted); font-weight:500; }
        .data-table td { padding:10px; border-bottom:1px solid #222; vertical-align:middle; }
        .data-table tr:hover td { background:#1a1a1a; }
        .thumb-sm { width:40px; height:40px; border-radius:4px; object-fit:cover; border:1px solid var(--border); }
        .status-pill { background:rgba(37, 244, 238, 0.1); color:var(--accent); padding:2px 8px; border-radius:4px; font-size:11px; }
        .btn-icon { background:none; border:none; color:var(--text-muted); cursor:pointer; padding:5px; border-radius:4px; }
        .btn-icon:hover { background:#222; color:var(--pink); }
        .badge-ai { font-size:9px; background:#112a2a; color:var(--accent); padding:2px 5px; border-radius:3px; margin-left:5px; border:1px solid #1a4444; display:none; }
        @media (max-width: 900px) { body { flex-direction:column; height:auto; overflow:auto; } .sidebar { width:100%; padding:20px; flex-direction:row; align-items:center; flex-wrap:wrap; } .creator-layout { grid-template-columns:1fr; } }
    </style>
</head>
<body>

    <nav class="sidebar">
        <div class="brand"><span>ALVES 7</span> MASTER</div>
        <div class="menu-group">
            <div class="menu-title">Cria√ß√£o</div>
            <button class="nav-btn active" onclick="switchTab('creator', this)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg> Editor de Produto
            </button>
        </div>
        <div class="menu-group">
            <div class="menu-title">Gerenciamento</div>
            <button class="nav-btn" onclick="switchTab('vitrine', this)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg> Vitrine da Loja
            </button>
        </div>
        <div style="margin-top: auto;">
            <button class="nav-btn" onclick="window.open('index.html', '_blank')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg> Visualizar Loja
            </button>
        </div>
    </nav>

    <div class="main-content">
        <div class="top-bar">
            <div class="top-title"><h1 id="page-title">Editor de Produto</h1></div>
            <div class="top-actions"><a href="#" class="btn-link">Suporte</a></div>
        </div>

        <div class="workspace">
            <div id="tab-creator" class="tab-view active creator-layout">
                <div class="control-panel">
                    <div class="upload-wrapper">
                        <input type="file" id="htmlLoader" accept=".html" style="display: none;" onchange="loadHtmlFile(this)">
                        <button class="btn-upload" onclick="document.getElementById('htmlLoader').click()">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                            Carregar/Editar HTML Existente
                        </button>
                    </div>

                    <details open>
                        <summary>Informa√ß√µes Principais</summary>
                        <div class="details-content">
                            <div class="form-group">
                                <label>T√≠tulo do Produto <span id="autoBadge" class="badge-ai">IA ATIVA</span></label>
                                <input type="text" id="pTitle" placeholder="Ex: Cooktop 5 Bocas, iPhone 13..." oninput="updatePreview()" onkeyup="handleTitleChange(this.value)">
                            </div>
                            <div class="form-group">
                                <label>Link de Compra</label>
                                <input type="text" id="pCheckout" placeholder="https://pay..." value="#" oninput="updatePreview()">
                            </div>
                            <div class="form-row">
                                <div><label>Pre√ßo Atual</label><input type="text" id="pPrice" value="R$ 0,00" oninput="updatePreview()"></div>
                                <div><label>Pre√ßo Antigo</label><input type="text" id="pOldPrice" value="R$ 0,00" oninput="updatePreview()"></div>
                            </div>
                            <div class="form-row">
                                <div><label>Desconto</label><input type="text" id="pDiscount" value="0%" oninput="updatePreview()"></div>
                                <div><label>T√≠tulo da Aba</label><input type="text" id="pPageTitle" value="Loja" oninput="updatePreview()"></div>
                            </div>
                        </div>
                    </details>

                    <details>
                        <summary>Especifica√ß√µes T√©cnicas</summary>
                        <div class="details-content">
                            <div class="form-group"><label>Gerado pela IA (Autom√°tico)</label><textarea id="pSpecs" rows="12" oninput="updatePreview()"></textarea></div>
                        </div>
                    </details>

                    <details>
                        <summary>Imagens</summary>
                        <div class="details-content">
                            <div class="form-group"><label>Imagem 1 (Principal)</label><input type="text" id="pImg1" oninput="updatePreview()"></div>
                            <div class="form-group"><label>Imagem 2</label><input type="text" id="pImg2" oninput="updatePreview()"></div>
                            <div class="form-group"><label>Imagem 3</label><input type="text" id="pImg3" oninput="updatePreview()"></div>
                            <div class="form-group"><label>Imagem 4</label><input type="text" id="pImg4" oninput="updatePreview()"></div>
                        </div>
                    </details>

                    <details>
                        <summary>Avalia√ß√µes Avan√ßadas</summary>
                        <div class="details-content">
                            <button onclick="randomizeAllAvatars()" class="btn btn-secondary" style="width:100%; margin-bottom:15px;">üé≤ Gerar Novos Rostos</button>
                            <div id="reviewsContainer"></div>
                        </div>
                    </details>

                    <div class="action-bar">
                        <button class="btn btn-secondary" onclick="addToStore()">Salvar na Vitrine</button>
                        <button class="btn btn-primary" onclick="generateFile()">Baixar HTML</button>
                    </div>
                </div>

                <div class="preview-stage">
                    <div class="device-mockup">
                        <div class="device-notch"></div>
                        <iframe id="previewFrame"></iframe>
                    </div>
                </div>
            </div>

            <div id="tab-vitrine" class="tab-view">
                <div class="vitrine-layout">
                    <div class="card">
                        <div style="background:#1a1a1a; padding:15px; border-radius:8px; margin-bottom:20px; font-size:12px; color:#aaa; border-left:3px solid #fe2c55;">
                            <strong>DICA:</strong> Os produtos listados aqui aparecer√£o automaticamente na se√ß√£o "Voc√™ tamb√©m pode gostar" de todos os produtos que voc√™ criar.
                        </div>
                        <table class="data-table">
                            <thead><tr><th width="60">Img</th><th>Produto</th><th>Pre√ßo</th><th>Status</th><th width="50">A√ß√£o</th></tr></thead>
                            <tbody id="storeListBody"></tbody>
                        </table>
                    </div>
                    <button onclick="resetStore()" style="margin-top:20px; background:none; border:1px solid #333; color:#555; padding:8px 15px; border-radius:4px; cursor:pointer;">Limpar Tudo</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- FUN√á√ÉO PARA IMPORTAR/EDITAR HTML EXISTENTE ---
        function loadHtmlFile(input) {
            const file = input.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                const parser = new DOMParser();
                const doc = parser.parseFromString(content, 'text/html');
                try {
                    document.getElementById('pTitle').value = doc.querySelector('.product-title').innerText;
                    document.getElementById('pPrice').value = doc.querySelector('.preco-atual-ativa').innerText;
                    document.getElementById('pOldPrice').value = doc.querySelector('.preco-antigo-ativa').innerText;
                    document.getElementById('pDiscount').value = doc.querySelector('.desconto-tag-ativa').innerText.replace('Economize ', '');
                    document.getElementById('pPageTitle').value = doc.querySelector('title').innerText;
                    document.getElementById('pCheckout').value = doc.querySelector('.buy-button').getAttribute('href');
                    
                    const imgs = doc.getElementById('gallery').querySelectorAll('img');
                    for(let i = 1; i <= 4; i++) { document.getElementById(`pImg${i}`).value = imgs[i-1] ? imgs[i-1].src : ''; }
                    
                    const specItems = doc.querySelectorAll('.specs-list li');
                    let specString = "";
                    specItems.forEach(li => { specString += `${li.querySelector('strong').innerText.replace(':', '')}: ${li.querySelector('span').innerText}\n`; });
                    document.getElementById('pSpecs').value = specString;
                    
                    const reviews = doc.querySelectorAll('.review-card');
                    reviews.forEach((card, index) => {
                        const i = index + 1;
                        if(i > 5) return;
                        document.getElementById(`rName${i}`).value = card.querySelector('.reviewer-name').innerText;
                        document.getElementById(`rImg${i}`).value = card.querySelector('.reviewer-avatar').src;
                        document.getElementById(`rText${i}`).value = card.querySelector('.review-text').innerText;
                        document.getElementById(`rStars${i}`).value = card.querySelectorAll('.star-icon-svg').length;
                        
                        const timeSpan = card.querySelector('.review-time-ago');
                        if (timeSpan) {
                            document.getElementById(`rTime${i}`).value = timeSpan.innerText.replace('‚Ä¢ ', '');
                        } else {
                            document.getElementById(`rTime${i}`).value = gerarTempoAleatorio();
                        }

                        const replyBox = card.querySelector('.seller-reply-box');
                        document.getElementById(`rReply${i}`).value = replyBox ? replyBox.innerText.replace('Resposta da Loja:', '').trim() : "";
                        const pics = []; card.querySelectorAll('.review-media-item').forEach(m => pics.push(m.src));
                        document.getElementById(`rPic${i}`).value = pics.join(', ');
                    });
                    alert("Arquivo carregado com sucesso!"); updatePreview();
                } catch (err) { alert("Erro ao ler o arquivo."); console.error(err); }
            };
            reader.readAsText(file);
        }

        // --- L√ìGICA DA VITRINE ---
        const STORAGE_KEY = 'tiktokShopProducts';
        function addToStore() {
            const title = document.getElementById('pTitle').value;
            if(!title) { alert("Preencha o t√≠tulo!"); return; }
            const newProd = { id: Date.now(), title: title, price: document.getElementById('pPrice').value, oldPrice: document.getElementById('pOldPrice').value, img: document.getElementById('pImg1').value, link: title.toLowerCase().replace(/[^\w\s-]/g, '').replace(/\s+/g, '-').substring(0, 30) + ".html" };
            let products = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            products.unshift(newProd);
            localStorage.setItem(STORAGE_KEY, JSON.stringify(products));
            alert("Salvo na Vitrine!"); renderStoreList(); updatePreview();
        }
        function renderStoreList() {
            const list = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            const tbody = document.getElementById('storeListBody');
            tbody.innerHTML = list.length ? '' : '<tr><td colspan="5" style="text-align:center; padding:20px; color:#666;">Vitrine vazia.</td></tr>';
            list.forEach((p, index) => { tbody.innerHTML += `<tr><td><img src="${p.img}" class="thumb-sm" onerror="this.src='https://placehold.co/40'"></td><td><div style="font-weight:600; color:#fff;">${p.title}</div></td><td style="color:#fff;">${p.price}</td><td><span class="status-pill">Ativo</span></td><td><button class="btn-icon" onclick="removeStoreItem(${index})">üóëÔ∏è</button></td></tr>`; });
        }
        function removeStoreItem(index) { let l = JSON.parse(localStorage.getItem(STORAGE_KEY)); l.splice(index, 1); localStorage.setItem(STORAGE_KEY, JSON.stringify(l)); renderStoreList(); updatePreview(); }
        function resetStore() { if(confirm("Limpar tudo?")) { localStorage.removeItem(STORAGE_KEY); renderStoreList(); updatePreview(); } }
        function switchTab(tab, el) { document.querySelectorAll('.tab-view').forEach(t => t.classList.remove('active')); document.getElementById('tab-'+tab).classList.add('active'); document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active')); el.classList.add('active'); if(tab==='vitrine') renderStoreList(); }

        // ============================================================
        // 1. SUPER BASE DE DADOS DE ESPECIFICA√á√ïES (MEGA DETALHADA)
        // ============================================================
        const specsDB = {
            "iphone11": "Marca: Apple\nModelo: iPhone 11\nProcessador: A13 Bionic (6-core)\nMem√≥ria RAM: 4GB\nArmazenamento: 64GB / 128GB\nTela: Liquid Retina HD LCD 6.1\"\nC√¢mera Traseira: Dupla 12MP (Ultra-angular)\nBateria: At√© 17h de v√≠deo\nConectividade: 4G LTE\nResist√™ncia: IP68 (√°gua e poeira)\nConte√∫do: iPhone, Cabo USB-C",
            "iphone12": "Marca: Apple\nModelo: iPhone 12\nProcessador: A14 Bionic (5nm)\nTela: Super Retina XDR OLED 6.1\"\nConectividade: 5G\nC√¢mera: Dupla 12MP (Modo Noite)\nResist√™ncia: Ceramic Shield\nMagSafe: Compat√≠vel\nBateria: At√© 17h v√≠deo\nConte√∫do: iPhone, Cabo USB-C",
            "iphone13": "Marca: Apple\nModelo: iPhone 13\nProcessador: A15 Bionic\nArmazenamento: In√≠cio 128GB\nTela: Super Retina XDR OLED 6.1\"\nModo Cinema: 1080p a 30 qps\nBateria: At√© 19h v√≠deo\nResist√™ncia: IP68\nConectividade: 5G, Wi-Fi 6\nConte√∫do: iPhone, Cabo USB-C",
            "iphone14": "Marca: Apple\nModelo: iPhone 14\nProcessador: A15 Bionic (GPU 5 n√∫cleos)\nTela: Super Retina XDR OLED 6.1\"\nSeguran√ßa: Detec√ß√£o de Acidentes\nC√¢mera Principal: 12MP (∆í/1.5)\nModo A√ß√£o: V√≠deos estabilizados\nBateria: At√© 20h v√≠deo\nConectividade: 5G",
            "iphone15": "Marca: Apple\nModelo: iPhone 15\nProcessador: A16 Bionic\nConex√£o: USB-C\nTela: Dynamic Island\nC√¢mera Principal: 48MP\nZoom: √ìptico de 2x\nDesign: Vidro colorido e alum√≠nio\nSeguran√ßa: SOS via sat√©lite\nBateria: Dia todo",
            "iphone16": "Marca: Apple\nModelo: iPhone 16\nProcessador: A18 (Neural Engine)\nIntelig√™ncia: Apple Intelligence\nBot√£o Novo: Controle da C√¢mera\nTela: Bordas ultrafinas\nC√¢mera Ultra-Wide: 48MP Macro\nConectividade: Wi-Fi 7\nCarregamento: MagSafe 25W",
            "iphone17": "Marca: Apple (Futuro)\nModelo: iPhone 17 Pro Max\nProcessador: A19 Pro (2nm)\nMem√≥ria RAM: 12GB\nTela: 6.9\" ProMotion 120Hz\nC√¢mera Frontal: 24MP\nConectividade: Chip Wi-Fi Apple\nSeguran√ßa: Face ID sob a tela\nAcabamento: Tit√¢nio Grau 5",
            "samsung": "Marca: Samsung\nLinha: Galaxy S / A\nTela: Dynamic AMOLED 2X 120Hz\nProcessador: Snapdragon 8 Gen / Exynos\nMem√≥ria RAM: 8GB / 12GB\nArmazenamento: 128GB a 1TB\nC√¢mera: Nightography\nZoom: Space Zoom at√© 100x (Ultra)\nBateria: 5000mAh\nCarregamento: Super Fast 45W",
            "xiaomi": "Marca: Xiaomi / Redmi / Poco\nProcessador: Snapdragon / MediaTek\nMem√≥ria RAM: 6GB / 8GB / 12GB\nArmazenamento: UFS r√°pido\nTela: AMOLED ou IPS 120Hz\nC√¢mera: At√© 200MP com OIS\nBateria: 5000mAh a 6000mAh\nCarregamento: HyperCharge (33W a 120W)\nSistema: HyperOS / MIUI",
            "air fryer": "Capacidade: 3,5L / 4L / 5,5L\nPot√™ncia: 1500W a 1900W\nTecnologia: Ar Quente 360¬∫\nCesto: Antiaderente Remov√≠vel\nLimpeza: F√°cil de lavar\nTimer: 60 min com desligamento\nTemperatura: 80¬∫C a 200¬∫C\nLuzes: Funcionamento e Aquecimento\nAcabamento: Inox ou Black Piano\nVoltagem: 127V ou 220V",
            "geladeira": "Tipo: Frost Free\nConfigura√ß√£o: Duplex ou Inverse\nCapacidade: 375L a 579L\nEfici√™ncia: A+++\nTecnologia: Inverter\nPrateleiras: Vidro Temperado\nGavet√£o: Hortifruti\nCongelamento: Turbo Freezer\nIlumina√ß√£o: LED",
            "fogao": "Bocas: 4, 5 ou 6 Queimadores\nAcendimento: Autom√°tico Total\nMesa: Vidro Temperado\nQueimadores: 1 Tripla Chama\nGrades: Ferro Fundido\nForno: Limpa F√°cil com Luz\nVidro Forno: Duplo panor√¢mico\nCapacidade Forno: 50L a 96L\nPuxador: Alum√≠nio escovado",
            "cooktop": "Instala√ß√£o: Bancada (Nicho)\nBocas: 4 ou 5\nAlimenta√ß√£o: G√°s ou Indu√ß√£o\nMesa: Vidro Temperado 6mm\nAcendimento: Superautom√°tico\nQueimadores: Selados\nPot√™ncia: 1 R√°pido (3000W)\nGrades: A√ßo Esmaltado ou Ferro\nEfici√™ncia: Classe A",
            "microondas": "Capacidade: 20L a 32L\nPot√™ncia: 1200W\nFun√ß√µes: Descongelar, Pipoca, Kids\nPainel: Digital Touch\nPorta: Espelhada\nPrato: Girat√≥rio de vidro\nEfici√™ncia: Classe A",
            "lavaloucas": "Servi√ßos: 8, 10 ou 14\nProgramas: 6 Ciclos de Lavagem\nEconomia: Baixo consumo de √°gua\nFun√ß√£o: Secagem Extra\nFiltro: Res√≠duos\nPainel: Touch Blue",
            "liquidificador": "Pot√™ncia: 1200W\nVelocidades: 12 + Pulsar\nL√¢minas: 6 facas em a√ßo inox\nCopo: Resistente a quedas (3L)\nFiltro: Incluso",
            "batedeira": "Tipo: Planet√°ria\nVelocidades: 8 a 12\nBatedores: 3 (Leves, M√©dias, Pesadas)\nTigela: Inox ou Pl√°stico (4L)\nSistema: Soft Start",
            "cafeteira": "Tipo: Expresso / C√°psula\nPress√£o: 15 a 19 Bar\nReservat√≥rio: Remov√≠vel\nAquecimento: R√°pido\nDesligamento: Autom√°tico",
            "panelas": "Material: Alum√≠nio com Revestimento Cer√¢mico\nPe√ßas: Jogo de 5 a 7 unidades\nAntiaderente: Classifica√ß√£o A (N√£o gruda)\nCabos: Soft-Touch (N√£o esquenta)\nCompatibilidade: G√°s e El√©trico (Verificar indu√ß√£o)",
            "potes": "Material: Vidro Borossilicato\nVeda√ß√£o: Herm√©tica com Silicone\nTravas: 4 laterais\nUso: Freezer, Micro-ondas e Forno (S/ tampa)\nLivre de BPA: Sim",
            "aspirador": "Tipo: Rob√¥ ou Vertical\nFiltro: HEPA (Ret√©m √°caros)\nBateria: 30 a 90 min\nFun√ß√£o: Aspira e Passa Pano (Rob√¥)\nReservat√≥rio: F√°cil limpeza",
            "lavadora": "Capacidade: 11kg a 16kg\nCiclos: M√∫ltiplos programas\nCesto: A√ßo Inox\nEconomia: Reaproveitamento de √°gua\nCentrifuga√ß√£o: Turbo",
            "sofa": "Modelo: Retr√°til e Reclin√°vel\nLugares: 2, 3 ou 4\nTecido: Suede ou Veludo\nEstrutura: Madeira Eucalipto\nAssento: Espuma D28 / Molas\nEstilo: Moderno",
            "cadeira": "Tipo: Gamer ou Escrit√≥rio\nErgonomia: Ajuste de altura\nRod√≠zios: Anti-risco\nRevestimento: Couro ou Mesh\nPeso: At√© 120kg",
            "furadeira": "Fun√ß√£o: Furadeira e Parafusadeira\nMandril: 3/8\" (10mm)\nVelocidade: Vari√°vel\nImpacto: Sim (Concreto)\nKit: Maleta inclusa",
            "generic": "Produto: 100% Original\nDisponibilidade: Pronta Entrega\nEnvio: Imediato para todo Brasil\nGarantia: Do Fabricante (3 a 12 meses)\nNota Fiscal: Emitida no seu nome\nEstado: Novo, lacrado\nManual: Instru√ß√µes em Portugu√™s"
        };

        // ============================================================
        // 2. DATABASE DE REVIEWS (SEPARADA E HUMANIZADA)
        // ============================================================
        const reviewsDB = {
            "tech_mobile": [ 
                { text: "Celular top dms! üòç A camera de noite fica perfeita. Bateria ta durando o dia todo cmg mexendo direto.", reply: "Arrase nas fotos! üì∏" },
                { text: "Chegou hj, bem antes do prazo. Aparelho lacrado, td certinho. Transferi meus dados e ta rodando liso.", reply: "Seguran√ßa √© com a gente! üòâ" },
                { text: "Melhor custo beneficio. Carrega mto rapido, em 40 min ja ta 100%.", reply: "" },
                { text: "Tava com medo de comprar online mas a loja √© confiavel. Produto original msm, conferi o imei.", reply: "Obrigado pela confian√ßa!" },
                { text: "Design mt chique, pessoalmente √© mais bonito q na foto. Veio bem embalado.", reply: "" } 
            ],
            
            "fogao_cooktop": [ 
                { text: "O fog√£o √© lindo! A chama √© muito forte üî•, a agua ferve rapidinho. O forno assa o bolo por igual.", reply: "Sua cozinha ficou mais moderna! üç∞" },
                { text: "Cooktop top, facil de limpar o vidro, s√≥ passar um pano. Instala√ß√£o foi tranquila.", reply: "" },
                { text: "As grades de ferro sao pesadas, a panela nao escorrega. Passa mta seguran√ßa.", reply: "Seguran√ßa na cozinha √© tudo!" },
                { text: "Chegou sem nenhum arranh√£o, embalagem refor√ßada. O design dele √© mto moderno.", reply: "" },
                { text: "Amei os bot√µes removiveis, facilita mto a limpeza dps de fazer fritura.", reply: "" }
            ],

            "geladeira": [ 
                { text: "Geladeira giganteeee! Cabe a compra do m√™s de boa. Gela muito rapido, cerveja fica trincando üç∫", reply: "Espa√ßo n√£o vai faltar! ‚ùÑÔ∏è" },
                { text: "Muito silenciosa, nem parece q ta ligada. O motor inverter economiza mto luz.", reply: "Efici√™ncia e sil√™ncio!" },
                { text: "O freezer √© enorme, cabe pote de sorvete e carne pra semana toda. Adorei.", reply: "" },
                { text: "Design moderno, deixou minha cozinha com cara de rica kkk Chegou no prazo.", reply: "" },
                { text: "Prateleiras de vidro sao resistentes. O painel touch na porta √© mto chique.", reply: "" }
            ],

            "cozinha_eletro": [ 
                { text: "Gente, essa Air Fryer √© vida! Fa√ßo tudo sem oleo e fica crocante. Nao vivo mais sem üçü", reply: "Sa√∫de e sabor! ü•∞" },
                { text: "Muito potente, tritura at√© gelo. O copo √© resistente, caiu no ch√£o e nao quebrou.", reply: "" },
                { text: "Chegou certinho, voltagem correta. Linda na bancada, todo mundo elogia.", reply: "" },
                { text: "Batedeira top, bate clara em neve em segundos. Bowl grande.", reply: "" },
                { text: "Caf√© sai quentinho. Entrega a jato, comprei num dia chegou no outro.", reply: "" }
            ],

            "moveis": [
                { text: "Sof√° nuvem de tao confortavel! O tecido √© macio. Chegou antes do prazo.", reply: "Conforto total! üõãÔ∏è" },
                { text: "Cadeira salvou minhas costas, passo o dia sentado e nao sinto dor.", reply: "Ergonomia √© sa√∫de!" },
                { text: "Facil de montar, veio com a chavinha. Cor igual da foto.", reply: "" },
                { text: "Mesa firme, nao balan√ßa. Custo beneficio excelente.", reply: "" },
                { text: "Guarda roupa espa√ßoso, gavetas correm bem. Lindo dms.", reply: "" }
            ],

            "generico": [
                { text: "Chegou super rapido aqui no RJ. Produto de qualidade, igual no anuncio. üëç", reply: "Log√≠stica vapt-vupt! üöÄ" },
                { text: "Gostei bastante! Tive duvida no rastreio e o suporte atendeu super bem.", reply: "Estamos √† disposi√ß√£o!" },
                { text: "Pelo pre√ßo vale mto a pena. Acabamento bom. Veio bem embalado.", reply: "" },
                { text: "Fiquei com medo mas me surpreendi. Podem comprar sem medo, √© confiavel.", reply: "Obrigado pela prefer√™ncia! ‚ù§Ô∏è" },
                { text: "Produto top, chegou tudo certinho. Recomendo.", reply: "" }
            ]
        };

        const nomesBR = ["Ana", "Bruno", "Carla", "Daniel", "Eduarda", "Felipe", "Gabriela", "Hugo", "Isabela", "Jo√£o", "Karina", "Lucas", "Mariana", "Nicolas", "Ol√≠via", "Pedro", "Quintino", "Rafael", "Sofia", "Thiago", "Ursula", "Vin√≠cius", "Wanessa", "Xavier", "Yasmim", "Zeca", "Amanda", "Beatriz", "Caio", "Diego", "Elaine", "Fernando", "Gustavo", "Helo√≠sa", "Igor", "J√∫lia", "Kevin", "Larissa", "Matheus", "Nat√°lia", "Patr√≠cia", "Renato", "S√©rgio", "Tatiane", "Vitor"];
        const sobrenomesBR = ["Silva", "Santos", "Oliveira", "Souza", "Rodrigues", "Ferreira", "Alves", "Pereira", "Lima", "Gomes", "Costa", "Ribeiro", "Martins", "Carvalho", "Almeida", "Lopes", "Soares", "Fernandes", "Vieira", "Barbosa", "Rocha", "Dias", "Nascimento", "Andrade", "Moreira", "Nunes", "Marques", "Machado", "Mendes", "Freitas", "Cardoso", "Ramos"];
        function gerarNomeAleatorio() { return `${nomesBR[Math.floor(Math.random()*nomesBR.length)]} ${sobrenomesBR[Math.floor(Math.random()*sobrenomesBR.length)]}`; }

        function gerarTempoAleatorio() {
            const min = 50; 
            const max = 4320; // 3 dias em minutos
            const rand = Math.floor(Math.random() * (max - min + 1)) + min;

            if (rand < 60) return `${rand} min atr√°s`;
            if (rand < 1440) {
                const h = Math.floor(rand / 60);
                return `${h} ${h === 1 ? 'hora' : 'horas'} atr√°s`;
            }
            const d = Math.floor(rand / 1440);
            return `${d} ${d === 1 ? 'dia' : 'dias'} atr√°s`;
        }

        // --- GATILHO (CHAIN REACTION) ---
        function handleTitleChange(title) {
            autoFillSpecs(title);
        }

        function autoFillSpecs(title) {
            const t = title.toLowerCase();
            let foundSpec = specsDB.generic;
            const keys = Object.keys(specsDB).sort((a, b) => b.length - a.length);
            
            for (let key of keys) {
                if (t.includes(key)) {
                    foundSpec = specsDB[key];
                    document.getElementById('autoBadge').style.display = 'inline-block';
                    document.getElementById('autoBadge').innerText = "IA: " + key.toUpperCase();
                    break;
                }
            }
            
            const specsField = document.getElementById('pSpecs');
            specsField.value = foundSpec;
            
            autoFillReviews(title, foundSpec);
            updatePreview();
        }

        function autoFillReviews(title, specs) {
            const textToAnalyze = (title + " " + specs).toLowerCase();
            let category = "generico";

            if (textToAnalyze.includes("fogao") || textToAnalyze.includes("fog√£o") || textToAnalyze.includes("cooktop") || textToAnalyze.includes("bocas") || textToAnalyze.includes("chama")) {
                category = "fogao_cooktop";
            } 
            else if (textToAnalyze.includes("geladeira") || textToAnalyze.includes("refrigerador") || textToAnalyze.includes("frost free") || textToAnalyze.includes("gela")) {
                category = "geladeira";
            }
            else if (textToAnalyze.match(/(iphone|samsung|galaxy|xiaomi|motorola|celular|smartphone)/)) {
                category = "tech_mobile";
            }
            else if (textToAnalyze.match(/(air fryer|fritadeira|batedeira|liquidificador|cafeteira)/)) {
                category = "cozinha_eletro";
            }
            else if (textToAnalyze.match(/(sofa|sof√°|cadeira|poltrona|mesa|cama)/)) {
                category = "moveis";
            }

            let pool = [...(reviewsDB[category] || reviewsDB["generico"])];
            if (Math.random() > 0.6) pool = pool.concat(reviewsDB["generico"]);
            pool.sort(() => 0.5 - Math.random());

            for(let i=1; i<=5; i++) {
                const review = pool[i-1] || pool[0];
                if(review) {
                    document.getElementById(`rText${i}`).value = review.text;
                    document.getElementById(`rReply${i}`).value = review.reply;
                    document.getElementById(`rName${i}`).value = gerarNomeAleatorio();
                    document.getElementById(`rTime${i}`).value = gerarTempoAleatorio();
                    document.getElementById(`rStars${i}`).value = Math.random() > 0.2 ? "5" : "4";
                    
                    if(typeof getRandomAvatarUrl === "function") { 
                        document.getElementById(`rImg${i}`).value = getRandomAvatarUrl(); 
                    }
                }
            }
        }

        const AVATAR_CONFIG = { folder: 'avatar/', total: 100, ext: '.jpg' };
        function getRandomAvatarUrl() { const num = Math.floor(Math.random() * AVATAR_CONFIG.total) + 1; return `${AVATAR_CONFIG.folder}(${num})${AVATAR_CONFIG.ext}`; }
        function randomizeAvatar(id) { document.getElementById(`rImg${id}`).value = getRandomAvatarUrl(); updatePreview(); }
        function randomizeAllAvatars() { for(let i=1; i<=5; i++) { const v = document.getElementById(`rImg${i}`).value; if(!v || v.includes('http')) document.getElementById(`rImg${i}`).value = getRandomAvatarUrl(); } updatePreview(); }

        const rc = document.getElementById('reviewsContainer');
        rc.innerHTML = ''; 
        for(let i=1; i<=5; i++) {
            rc.innerHTML += `
            <div style="border-bottom:1px solid #333; padding-bottom:15px; margin-bottom:15px; background:#111; padding:10px; border-radius:6px;">
                <div style="font-size:11px; color:#25f4ee; margin-bottom:5px; font-weight:bold;">AVALIA√á√ÉO #${i}</div>
                <div class="form-row">
                    <input type="text" id="rName${i}" value="Cliente ${i}" oninput="updatePreview()" placeholder="Nome">
                    <select id="rStars${i}" onchange="updatePreview()" style="background:#0a0a0a;"><option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option><option value="4">‚≠ê‚≠ê‚≠ê‚≠ê</option><option value="3">‚≠ê‚≠ê‚≠ê</option></select>
                </div>
                <div class="form-row" style="margin-top:5px;">
                    <input type="text" id="rTime${i}" placeholder="Tempo (ex: 2 horas atr√°s)" oninput="updatePreview()" style="border:1px solid #444;">
                </div>
                <div style="display:flex; gap:5px; margin-top:5px;">
                    <input type="text" id="rImg${i}" value="https://randomuser.me/api/portraits/men/${i}.jpg" oninput="updatePreview()" placeholder="Avatar URL">
                    <button onclick="randomizeAvatar(${i})" class="btn-secondary" style="padding:0 10px;">üé≤</button>
                </div>
                <textarea id="rText${i}" rows="2" oninput="updatePreview()" style="margin-top:5px;" placeholder="Coment√°rio..."></textarea>
                <input type="text" id="rPic${i}" placeholder="URLs das Fotos (separe por v√≠rgula)" oninput="updatePreview()" style="margin-top:5px; border-color:#333;">
                <div style="font-size:9px; color:#666; margin-bottom:5px;">Ex: foto1.jpg, foto2.jpg</div>
                <div style="margin-top:8px; border-top:1px solid #222; padding-top:8px;">
                    <label style="color:#fe2c55;">Resposta da Loja</label>
                    <input type="text" id="rReply${i}" placeholder="Deixe em branco para n√£o responder" oninput="updatePreview()">
                </div>
            </div>`;
        }

        const templateBase = `<!DOCTYPE html><html lang="pt-BR"><head><meta charset="UTF-8"><title>{{PAGE_TITLE}}</title><meta name="viewport" content="width=device-width, initial-scale=1"><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"><style> 
            :root { --bg-dark: #121212; --bg-card: #1e1e1e; --text-main: #fff; --text-muted: #aaa; --primary: #fe2c55; --cyan: #25f4ee; }
            body{background-color:var(--bg-dark)!important;color:var(--text-main)!important;margin:0;font-family:'Inter', sans-serif; padding-bottom: 90px; padding-top: 0px;} 
            .brand-logo{font-size:20px; font-weight:900; color:#fff; display:flex; align-items:center; gap:5px;}
            .fixed-bottom-bar{position:fixed;bottom:0;left:0;width:100%;display:flex;align-items:center;justify-content:space-between;gap:6px;padding:8px 12px;background:#1e1e1e;box-shadow:0 -2px 10px rgba(0,0,0,0.2);z-index:1000;box-sizing:border-box;border-top:1px solid #333;color:white;} 
            .left-group{display:flex;align-items:center;gap:15px;} 
            .bar-item{flex:none;display:flex;flex-direction:column;align-items:center;justify-content:center;text-decoration:none;color:#fff;font-size:0.7rem;font-weight:500;gap:2px;} 
            .bar-item svg{width:20px;height:20px;stroke:#fff;} 
            .cart-button{background:rgba(254,44,85,0.15);border-radius:12px;padding:8px;display:flex;align-items:center;justify-content:center;cursor:pointer;} 
            .cart-button svg{width:24px;height:24px;stroke:#fe2c55;} 
            .buy-button{flex:1;background:#fe2c55;border-radius:24px;text-decoration:none;color:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:8px;text-align:center;cursor:pointer; margin-left:10px;} 
            .buy-price{font-weight:800;font-size:1.1rem;} 
            .buy-text{font-size:0.7rem;line-height:1;} 
            .gallery-wrapper { position: relative; max-width: 100%; overflow: hidden; background:#fff;} 
            .gallery-container { display: flex; overflow-x: auto; scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch; scrollbar-width: none; height: 380px; } 
            .gallery-container::-webkit-scrollbar { display: none; } 
            .gallery-container img { flex: 0 0 100%; width: 100%; height: 100%; object-fit: contain; scroll-snap-align: center; } 
            .counter { position: absolute; bottom: 10px; right: 10px; background: rgba(0, 0, 0, 0.7); color: #fff; font-size: 12px; padding: 4px 10px; border-radius: 12px; font-weight:600; } 
            .oferta-container-ativa{padding:15px;background:#1e1e1e;border-bottom:1px solid #333;} 
            .oferta-preco-info-ativa{display:flex;justify-content:space-between;align-items:flex-end;} 
            .preco-atual-ativa{font-size:24px;font-weight:800;color:#fff;} 
            .preco-antigo-ativa{text-decoration:line-through;color:#888;font-size:14px;margin-right:8px;} 
            .desconto-tag-ativa{background:rgba(254,44,85,0.2);color:#fe2c55;padding:2px 6px;border-radius:4px;font-size:11px;font-weight:bold;} 
            .oferta-relampago-texto-ativa { color: #fe2c55; font-weight: bold; font-size: 12px; display: flex; align-items: center; gap: 5px; margin-top: 8px;} 
            .oferta-relampago-texto-ativa svg { width: 14px; } .contador-tempo-ativo { font-size: 12px; color: #ccc; margin-top: 2px; }
            .product-info-container{padding:15px;background:#1e1e1e; margin-bottom:10px;} 
            .product-title{font-size:16px;color:#fff;margin:10px 0; font-weight:600; line-height:1.4;} 
            .tag-row{display:flex;gap:5px;margin-bottom:8px;} 
            .discount-tag{background:#333;color:#ccc;font-size:10px;padding:3px 6px;border-radius:4px;}
            .rating-row { color: #ffc107; font-size: 12px; display:flex; align-items:center; gap:5px;}
            .section-container { padding: 15px; background: #1e1e1e; margin-bottom: 10px; border-bottom: 1px solid #333; }
            .service-item { display: flex; gap: 10px; margin-bottom: 15px; align-items: flex-start; }
            .service-icon { width: 20px; height: 20px; stroke: #fff; flex-shrink: 0; }
            .service-text { font-size: 12px; color: #ccc; display: flex; flex-direction: column; }
            .delivery-tag { color: #25f4ee; font-weight: 700; }
            .shipping-cost-old { text-decoration: line-through; color: #777; font-size: 11px;}
            .servicos-tiktok-dark { background: #222; border: 1px solid #333; border-radius: 8px; padding: 12px; }
            .servicos-tiktok-titulo { font-size: 13px; font-weight: 700; display:flex; gap:6px; margin-bottom:10px; align-items:center; color:#fff;}
            .servicos-tiktok-lista { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 11px; color: #aaa; }
            .servicos-tiktok-item::before { content: "‚úì"; color: #fe2c55; margin-right: 4px; font-weight: bold;}
            .seller-info-container { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: #1e1e1e; margin-bottom: 10px; border-top:1px solid #333;}
            .seller-details { display: flex; gap: 10px; align-items: center; }
            .seller-avatar { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 1px solid #333; }
            .store-name { font-weight: 700; font-size: 14px; display:flex; align-items:center; gap:4px; }
            .follow-button { background: transparent; border: 1px solid #fe2c55; color: #fe2c55; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; position: relative; overflow: hidden; }
            .follow-button.following { background: #fe2c55; color: white; border-color: #fe2c55; }
            .follow-button::after { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent); transition: none; }
            .follow-button.animate-shine::after { animation: shine 0.5s; }
            @keyframes shine { 100% { left: 100%; } }
            .specs-section { padding: 15px; background: #1e1e1e; margin-bottom: 10px; border-top: 1px solid #333; }
            .specs-section h3 { font-size: 15px; margin-bottom: 10px; font-weight: 700; color: #fff; }
            .specs-list { list-style: none; padding: 0; margin: 0; font-size: 12px; color: #ccc; }
            .specs-list li { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #333; }
            .specs-list li:last-child { border-bottom: none; }
            .specs-list li strong { color: #fff; font-weight: 600; }
            .review-section { padding: 15px; background: #1e1e1e; margin-bottom: 10px; }
            .review-heading { font-size: 16px; font-weight: 700; margin-bottom: 15px; }
            .review-card { background: #121212; border: 1px solid #333; padding: 12px; border-radius: 8px; margin-bottom: 10px; }
            .reviewer-info { display: flex; align-items: center; margin-bottom: 8px; }
            .reviewer-avatar { width: 32px; height: 32px; border-radius: 50%; margin-right: 10px; object-fit: cover; background: #333; }
            .reviewer-name { font-weight: 600; font-size: 13px; color: white; }
            .review-stars { display:flex; gap:2px; margin-bottom:5px; }
            .star-icon-svg { width:12px; height:12px; fill:#FFD700; }
            .star-empty-svg { width:12px; height:12px; fill:#444; }
            .review-text { font-size: 12px; color: #ddd; line-height: 1.4; }
            .review-media-grid { display: flex; gap: 5px; margin-top: 8px; overflow-x: auto; }
            .review-media-item { width: 60px; height: 60px; border-radius: 6px; object-fit: cover; border: 1px solid #333; cursor: zoom-in; flex-shrink: 0; background: #000; }
            .seller-reply-box { margin-top: 10px; background: #1a1a1a; border-left: 3px solid #25f4ee; padding: 10px; border-radius: 0 4px 4px 0; font-size: 11px; color: #ccc; }
            .seller-reply-title { color: #25f4ee; font-weight: 700; margin-bottom: 3px; display: flex; align-items: center; gap: 4px; }
            .suggestions-section { padding: 15px; background: #121212; }
            .masonry-grid { column-count: 2; column-gap: 10px; }
            .product-card { break-inside: avoid; margin-bottom: 10px; background: #1e1e1e; border-radius: 8px; overflow: hidden; position: relative; border: 1px solid #333; cursor: pointer; }
            .card-img { width: 100%; display: block; object-fit: cover; }
            .card-info { padding: 8px; }
            .card-title { font-size: 12px; margin-bottom: 4px; color: #fff; line-height: 1.3; }
            .card-price { font-weight: 700; color: #fe2c55; font-size: 13px; }
            .badge-row { display:flex; gap:4px; margin-top:4px; flex-wrap:wrap; }
            .badge-sm { font-size: 9px; padding: 2px 4px; border-radius: 3px; background: rgba(37, 244, 238, 0.15); color: #25f4ee; }
            .footer-menu { padding: 20px; background: #1e1e1e; font-size: 12px; color: #888; text-align: center; border-top: 1px solid #333; }
            .footer-links { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-top: 10px; }
            #imageModal { display: none; position: fixed; z-index: 9999; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.95); justify-content: center; align-items: center; flex-direction: column; }
            #modalContent { max-width: 95%; max-height: 90%; position: relative; display: flex; justify-content: center; align-items: center; }
            #modalImg, #modalVideo { max-width: 100%; max-height: 80vh; border-radius: 8px; box-shadow: 0 0 20px rgba(0,0,0,0.5); }
            .close-modal { position: absolute; top: 20px; right: 20px; color: white; font-size: 35px; cursor: pointer; z-index: 10000; background: rgba(0,0,0,0.5); width: 40px; height: 40px; text-align: center; line-height: 40px; border-radius: 50%; }
        </style></head><body><div class="gallery-wrapper"><div class="gallery-container" id="gallery">{{GALLERY_CONTENT}}</div><div class="counter" id="counter">1/{{IMG_COUNT}}</div></div><div class="oferta-container-ativa"><div class="oferta-preco-info-ativa"><div class="preco-atual-wrapper-ativa"><span class="preco-atual-ativa">{{PRICE_NEW}}</span></div><div class="preco-antigo-e-desconto-ativa"><span class="preco-antigo-ativa">{{PRICE_OLD}}</span><span class="desconto-tag-ativa">Economize {{DISCOUNT}}</span></div></div><div class="oferta-status-info-ativa"><span class="oferta-relampago-texto-ativa"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon></svg>OFERTA REL√ÇMPAGO</span><div class="contador-tempo-ativo" id="timer">TERMINA EM 00:04:19</div></div></div><div class="product-info-container"><div class="tag-row"><span class="discount-tag">Pre√ßo Promocional</span><span class="discount-tag">Economize {{DISCOUNT}}</span></div><h1 class="product-title">{{PRODUCT_TITLE}}</h1><div class="rating-row">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ <span>4.9 (100+ vendidos)</span></div></div><div class="section-container"><div class="service-item"><svg class="service-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="3" width="15" height="13"></rect><polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon><circle cx="5.5" cy="18.5" r="2.5"></circle><circle cx="18.5" cy="18.5" r="2.5"></circle></svg><div class="service-text"><span class="delivery-tag">Frete gr√°tis</span><span>Receba em at√© 7 dias</span><span class="shipping-cost-old">Taxa: R$ 15,00</span></div></div><div class="service-item"><svg class="service-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"></path><polyline points="12 6 16 10 8 14 12 18"></polyline></svg><div class="service-text"><span style="color:#fff; font-weight:600;">Devolu√ß√µes em 30 dias</span><span>Cancelamento f√°cil</span></div></div></div><div class="section-container" style="padding-top:0;"><div class="servicos-tiktok-dark"><div class="servicos-tiktok-titulo"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#25f4ee" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path></svg> Prote√ß√£o do Cliente</div><div class="servicos-tiktok-lista"><div class="servicos-tiktok-item">Prote√ß√£o ao comprador</div><div class="servicos-tiktok-item">Pagamento seguro</div><div class="servicos-tiktok-item">Reembolso r√°pido</div><div class="servicos-tiktok-item">Suporte 24h</div></div></div></div><div class="review-section"><h3 class="review-heading">Avalia√ß√µes dos clientes</h3>{{REVIEWS_CONTENT}}</div><div class="seller-info-container"><div class="seller-details"><img src="images/kk.png" class="seller-avatar" onerror="this.src='https://placehold.co/40?text=S'"><div><div class="store-name">TikTok Shop <svg width="12" height="12" viewBox="0 0 24 24" fill="#25f4ee"><circle cx="12" cy="12" r="10"></circle><path d="M9 12l2 2 4-4" stroke="#000" stroke-width="2"/></svg></div><div style="font-size:11px; color:#888;">+10k vendas</div></div></div><button class="follow-button">Seguir</button></div><div class="specs-section"><h3>Especifica√ß√µes do Produto</h3><ul class="specs-list">{{SPECS_CONTENT}}</ul></div><div class="suggestions-section"><h3 style="color:white; margin-bottom:15px;">Voc√™ tamb√©m pode gostar</h3><div class="masonry-grid">{{SUGGESTED_PRODUCTS}}</div></div><div class="footer-menu"><div class="footer-links"><span>Pol√≠tica de Privacidade</span> ‚Ä¢ <span>Termos de Uso</span> ‚Ä¢ <span>Ajuda</span></div><p style="margin-top:10px;">¬© 2025 TikTok Shop. Todos os direitos reservados.</p></div><div class="fixed-bottom-bar"><div class="left-group"><a href="index.html" class="bar-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg><span>Loja</span></a><a href="#" class="bar-item"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg><span>Chat</span></a></div><div class="cart-button"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg></div><a href="{{CHECKOUT_LINK}}" class="buy-button"><div class="buy-price">{{PRICE_NEW}}</div><div class="buy-text"><strong>Compre agora</strong></div></a></div><div id="imageModal"><span class="close-modal">&times;</span><div id="modalContent"><img id="modalImg" style="display:none;"><video id="modalVideo" style="display:none;" controls></video></div></div><script>const gallery=document.getElementById("gallery");const counter=document.getElementById("counter");const total={{IMG_COUNT}};if(total>1){gallery.addEventListener("scroll",()=>{const width=gallery.clientWidth;const index=Math.round(gallery.scrollLeft/width)+1;counter.textContent=index+"/"+total;});}let time=259;setInterval(()=>{if(time>0)time--;let m=Math.floor(time/60).toString().padStart(2,'0');let s=(time%60).toString().padStart(2,'0');document.getElementById('timer').innerText="TERMINA EM 00:"+m+":"+s;},1000);const modal=document.getElementById('imageModal');const modalImg=document.getElementById('modalImg');const modalVideo=document.getElementById('modalVideo');const closeBtn=document.querySelector('.close-modal');function openMedia(src,type){if(type==='video'){modalImg.style.display='none';modalVideo.style.display='block';modalVideo.src=src;modalVideo.play();}else{modalVideo.style.display='none';modalVideo.pause();modalImg.style.display='block';modalImg.src=src;}modal.style.display='flex';}document.querySelectorAll('.review-media-item').forEach(media=>{media.addEventListener('click',function(e){e.stopPropagation();const isVideo=this.tagName==='VIDEO'||this.src.endsWith('.mp4');openMedia(this.src,isVideo?'video':'image');});});closeBtn.addEventListener('click',()=>{modal.style.display='none';modalVideo.pause();});modal.addEventListener('click',(e)=>{if(e.target===modal){modal.style.display='none';modalVideo.pause();}});
            const followBtn = document.querySelector('.follow-button'); if(followBtn){ followBtn.addEventListener('click', function() { this.classList.toggle('following'); if(this.classList.contains('following')) { this.innerText = "Seguindo"; this.classList.add('animate-shine'); setTimeout(() => this.classList.remove('animate-shine'), 500); } else { this.innerText = "Seguir"; } }); }
            <\/script></body></html>`;

        function getStarsSVG(count) {
            const star = '<svg class="star-icon-svg" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>';
            const empty = '<svg class="star-empty-svg" viewBox="0 0 24 24"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>';
            return star.repeat(parseInt(count)) + empty.repeat(5 - parseInt(count));
        }

        function isVideoFile(src) { return src.toLowerCase().endsWith('.mp4'); }

        function updatePreview() {
            const title = document.getElementById('pTitle').value || "T√≠tulo";
            const price = document.getElementById('pPrice').value || "R$ 0,00";
            const oldPrice = document.getElementById('pOldPrice').value || "R$ 0,00";
            const discount = document.getElementById('pDiscount').value || "0%";
            const pageTitle = document.getElementById('pPageTitle').value || "Loja";
            const checkoutLink = document.getElementById('pCheckout').value || "#";
            const specsRaw = document.getElementById('pSpecs').value;
            
            const imgs = [document.getElementById('pImg1').value, document.getElementById('pImg2').value, document.getElementById('pImg3').value, document.getElementById('pImg4').value].filter(i=>i.trim()!=="");
            if(imgs.length===0) imgs.push('https://placehold.co/400x400/333/fff?text=Sem+Imagem');
            let galleryHtml = ""; imgs.forEach(img => { galleryHtml += `<img src="${img}" alt="Produto">`; });

            let specsHtml = "";
            if(specsRaw) {
                specsRaw.split('\n').forEach(line => {
                    if(line.trim()) {
                        const parts = line.split(':');
                        const key = parts[0]; const val = parts.slice(1).join(':');
                        specsHtml += `<li><strong>${key}:</strong> <span>${val}</span></li>`;
                    }
                });
            }

            let reviewsHtml = "";
            for(let i=1; i<=5; i++) {
                const name = document.getElementById(`rName${i}`).value;
                const img = document.getElementById(`rImg${i}`).value;
                const text = document.getElementById(`rText${i}`).value;
                const picInput = document.getElementById(`rPic${i}`).value;
                const starsCount = document.getElementById(`rStars${i}`).value;
                const reply = document.getElementById(`rReply${i}`).value;
                const time = document.getElementById(`rTime${i}`).value; // Pega o tempo
                
                if(name && text) {
                    const starsHtml = getStarsSVG(starsCount);
                    let mediaGridHtml = "";
                    if(picInput.trim()) {
                        const mediaUrls = picInput.split(',').map(u=>u.trim()).filter(u=>u!=="");
                        if(mediaUrls.length > 0) {
                            mediaGridHtml = '<div class="review-media-grid">';
                            mediaUrls.forEach(url => {
                                mediaGridHtml += isVideoFile(url) ? `<video src="${url}" class="review-media-item" autoplay muted loop playsinline preload="auto" style="background:#222; object-fit:cover;"></video>` : `<img src="${url}" class="review-media-item">`;
                            });
                            mediaGridHtml += '</div>';
                        }
                    }
                    let replyHtml = "";
                    if(reply && reply.trim() !== "") {
                        replyHtml = `<div class="seller-reply-box"><div class="seller-reply-title"><svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg> Resposta da Loja:</div>${reply}</div>`;
                    }
                    // Adiciona o tempo ao lado do nome
                    reviewsHtml += `<div class="review-card"><div class="reviewer-info"><img src="${img}" onerror="this.src='avatar/(1).jpg'" class="reviewer-avatar"><div class="reviewer-name">${name} <span class="review-time-ago" style="font-size:10px; color:#888; font-weight:400; margin-left:5px;">‚Ä¢ ${time}</span></div></div><div class="review-stars">${starsHtml}</div><div class="review-text">${text}</div>${mediaGridHtml}${replyHtml}</div>`;
                }
            }

            // --- GERA√á√ÉO DAS SUGEST√ïES (DIN√ÇMICO) ---
            const productsList = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            let suggestedHtml = "";

            if (productsList.length > 0) {
                productsList.forEach(p => {
                    const pImg = p.img && p.img.trim() !== "" ? p.img : 'https://placehold.co/400?text=Sem+Img';
                    suggestedHtml += `
                        </div>
                    </div>`;
                });
            } else {
                suggestedHtml = `<div style="grid-column: 1 / -1; text-align:center; color:#666; padding:20px; font-size:11px;">Salve produtos na vitrine para v√™-los aqui.</div>`;
            }

            let content = templateBase;
            content = content.replace(/{{PAGE_TITLE}}/g, pageTitle).replace(/{{PRODUCT_TITLE}}/g, title).replace(/{{PRICE_NEW}}/g, price).replace(/{{PRICE_OLD}}/g, oldPrice).replace(/{{DISCOUNT}}/g, discount).replace(/{{GALLERY_CONTENT}}/g, galleryHtml).replace(/{{IMG_COUNT}}/g, imgs.length).replace(/{{REVIEWS_CONTENT}}/g, reviewsHtml).replace(/{{CHECKOUT_LINK}}/g, checkoutLink).replace(/{{SUGGESTED_PRODUCTS}}/g, suggestedHtml).replace(/{{SPECS_CONTENT}}/g, specsHtml);

            const iframe = document.getElementById('previewFrame');
            const doc = iframe.contentDocument || iframe.contentWindow.document;
            doc.open(); doc.write(content); doc.close();
        }

        function generateFile() {
            const title = document.getElementById('pTitle').value;
            if(!title) { alert("Digite um t√≠tulo!"); return; }
            const iframe = document.getElementById('previewFrame');
            const content = iframe.contentDocument.documentElement.outerHTML;
            const blob = new Blob([content], {type: "text/html"});
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            const filename = title.toLowerCase().replace(/[^\w\s-]/g, '').replace(/\s+/g, '-').substring(0, 30) + ".html";
            a.href = url; a.download = filename;
            document.body.appendChild(a); a.click(); document.body.removeChild(a);
        }

        window.onload = updatePreview;
    </script>
</body>
</html>